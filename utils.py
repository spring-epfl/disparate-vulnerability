import pandas as pd
import numpy as np


def infer_from(model, X):
    """Infer from binary-label model."""
    if hasattr(model, "predict_proba"):
        infer_fn = lambda x: model.predict_proba(x)[:, 1]
    elif hasattr(model, "predict"):
        infer_fn = model.predict

    return infer_fn(X.values if isinstance(X, pd.DataFrame) else X)


def log_losses(y_true, y_pred, eps=1e-15):
    if not isinstance(y_pred, np.ndarray):
        y_pred = np.array(y_pred)
    if not isinstance(y_true, np.ndarray):
        y_true = np.array(y_true)
    y_pred = np.clip(y_pred, eps, 1 - eps)
    one_minus_y_pred = np.clip(1 - y_pred, eps, 1 - eps)
    return -(y_true * np.log(y_pred) + (1 - y_true) * np.log(one_minus_y_pred))
